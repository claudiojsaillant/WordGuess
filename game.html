<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta charset="UTF-8">
  <title>My First Object</title>
</head>

<body>
  <div id="game">
    <h1>Try to guess the word!</h1>
  </div>

  <div id="used">
    <p>Number of used words: <span id="wordsused"></span></p>
  </div>

  <div id="gameSpaces">
    <p>Your Guesses so far: <span id="answer"></span> </p>
  </div>

  <div id="message">
    <p id="finalmessage">Make your guess user!</p>
  </div>

  <div class="score-board">
    <div id="wins">Games won:<span id="wincount">0</span></div>
    <div id="losses">Games lost:<span id="lostcount">0</span></div>
  </div>



  <script>

    // Variables

    let gamesWon = document.getElementById("wincount");
    let gamesLost = document.getElementById("lostcount");
    let result = document.getElementById("finalmessage");
    let wordsUsedSpan = document.getElementById("wordsused");
    let answerSpan = document.getElementById("answer");

    var userPressed;
    var wordsUsed = [];
    var answer = [];
    var wordArray = [];
    var words = ["madonna", "seventies", "random", "jackson", "problem"];
    var chances = 10;
    var j = 0;
    var wArrayString = "";
    var aArrayString = "";
    var wins = 0;
    var losses = 0;


    // Functions  



    var checkWin = function (string1, string2) {
      if (string1 === string2) {
        console.log("you won!");
        wins++
        gamesWon.innerHTML = wins;
        reset();
      }
      else if (chances === 0) {
        losses ++;
        gamesLost.innerHTML = losses;
        reset();
      }
    }


    var guessed = function (rand) {
      for (i = 0; i < rand.length; i++) {
        if (userPressed === wordArray[i]) {
          answer[i] = wordArray[i];
        }
      }
    };

    var setSpaces = function (string) {
      for (i = 0; i < string.length; i++) {
        answer[i] = "_";
      }
    };

    var wordToArray = function (string) {
      wordArray = [];
      for (i = 0; i < string.length; i++) {
        wordArray[i] = string.charAt(i);
      }
    };

    function wordChecker(word) {
      update();
      if (wordsUsed.includes(word) || answer.includes(word)) {
        console.log("you already tried this word")
        checkWin(wArrayString, aArrayString);
      }
      else {
        if (wordArray.includes(word) && answer.includes(word) === false) {
          update();
          console.log("You guessed a word");
          checkWin(wArrayString, aArrayString);
        }
        else if (wordsUsed.includes(word) === false) {
          console.log("Try again");
          wordsUsed[j] = userPressed;
          j++;
          chances--;
          wordsUsedSpan.innerHTML = wordsUsed.join(", ");
          console.log("Chances: " + chances);
          if (chances === 0) {
            checkWin(wArrayString, aArrayString);
          }
        }
      }
    }

    function game() {
      var rand = words[Math.floor(Math.random() * words.length)];
      wordToArray(rand);
      setSpaces(rand);
      wArrayString = wordArray.join("");
      aArrayString = answer.join("");
      console.log(answer);
      answerSpan.innerHTML = answer.join(", ");
    }

    function reset() {
      answer = [];
      wordsUsed = [];
      chances = 10;
      j = 0;
      wArrayString = "";
      aArrayString = "";
      update();
      game();
    }


    document.onkeydown = function (event) {
      userPressed = event.key;
      update();
    }

    document.onkeyup = function (event) {
      wordChecker(userPressed);
      guessed(wordArray);
      answerSpan.innerHTML = answer.join(", ");
      update();
      checkWin(wArrayString, aArrayString);
    }

    function update() {
      aArrayString = "";
      wArrayString = "";
      wArrayString = wordArray.join("");
      aArrayString = answer.join("");
    }

    game();

  </script>

</body>

</html>