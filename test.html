<!DOCTYPE html>
<html lang="en-us">

<head>
    <meta charset="UTF-8">
    <title>My First Object</title>
</head>

<body>
    <div id="game">
        <h1>Try to guess the word!</h1>
    </div>

    <div id="used">
        <p>Used words: <span id="wordsused"></span></p>
    </div>

    <div id="gameSpaces">
        <p>Guess!: <span id="answer"></span> </p>
    </div>

    <div id="message">
        <p id="finalmessage">Make your guess user!</p>
    </div>

    <div class="score-board">
        <div id="chances">Chances left: <span id="chancescount">10</span> </div>
        <div id="wins">Games won: <span id="wincount">0</span></div>
        <div id="losses">Games lost: <span id="lostcount">0</span></div>
    </div>



    <script>

        // Variables for DOM manipulation

        let gamesWon = document.getElementById("wincount");
        let gamesLost = document.getElementById("lostcount");
        let result = document.getElementById("finalmessage");
        let wordsUsedSpan = document.getElementById("wordsused");
        let answerSpan = document.getElementById("answer");
        let message = document.getElementById("finalmessage");
        let chancesSpan = document.getElementById("chancescount");

        //OBJ

        var gameObject = {
            userPressed: "",
            words: ["madonna", "seventies", "random", "jackson", "problem"],
            wordsUsed: [],
            answer: [],
            wordArray: [],
            chances: 10,
            arrayTracker: 0,
            wins: 0,
            losses: 0,
            wArrayString: "",
            aArrayString: "",

            checkWin: function (string1, string2) {
                if (string1 === string2) {
                    message.innerHTML = "You won!";
                    this.wins++
                    gamesWon.innerHTML = this.wins;
                    this.reset();
                }
                else if (this.chances === 0) {
                    message.innerHTML = "You lost!";
                    this.losses++;
                    gamesLost.innerHTML = this.losses;
                    this.reset();
                }
            },

            guessed: function (rand) {
                for (i = 0; i < rand.length; i++) {
                    if (this.userPressed === this.wordArray[i]) {
                        this.answer[i] = this.wordArray[i];
                    }
                }
            },

            setSpaces: function (string) {
                for (i = 0; i < string.length; i++) {
                    this.answer[i] = "_";
                }
            },

            wordToArray: function (string) {
                this.wordArray = [];
                for (i = 0; i < string.length; i++) {
                    this.wordArray[i] = string.charAt(i);
                }
            },
            wordChecker: function (word) {
                this.update();
                if (this.wordsUsed.includes(word) || this.answer.includes(word)) {
                    message.innerHTML = "You already tried this word!";
                    this.checkWin(this.wArrayString, this.aArrayString);
                }
                else {
                    if (this.wordArray.includes(word) && this.answer.includes(word) === false) {
                        this.update();
                        message.innerHTML = "You guessed a word";
                        this.checkWin(this.wArrayString, this.aArrayString);
                    }
                    else if (this.wordsUsed.includes(word) === false) {
                        message.innerHTML = "Try again";
                        this.wordsUsed[this.arrayTracker] = this.userPressed;
                        this.arrayTracker++;
                        this.chances--;
                        wordsUsedSpan.innerHTML = this.wordsUsed.join(", ");
                        chancesSpan.innerHTML = this.chances;
                        if (this.chances === 0) {
                            this.checkWin(this.wArrayString, this.aArrayString);
                        }
                    }
                }
            },
            reset: function () {
                this.answer = [];
                this.wordsUsed = [];
                this.chances = 10;
                chancesSpan.innerHTML = this.chances;
                this.arrayTracker = 0;
                this.wArrayString = "";
                this.aArrayString = "";
                wordsUsedSpan.innerHTML = this.wordsUsed.join(", ");
                this.update();
                this.game();
            },
            update: function () {
                this.aArrayString = "";
                this.wArrayString = "";
                this.wArrayString = this.wordArray.join("");
                this.aArrayString = this.answer.join("");
            },
            game: function () {
                var rand = gameObject.words[Math.floor(Math.random() * gameObject.words.length)];
                this.wordToArray(rand);
                this.setSpaces(rand);
                this.wArrayString = this.wordArray.join("");
                this.aArrayString = this.answer.join("");
                answerSpan.innerHTML = this.answer.join(", ");
            }

        };

        // Key Functions 

        document.onkeydown = function (event) {
            gameObject.userPressed = event.key;
            gameObject.update();
        }

        document.onkeyup = function (event) {
            gameObject.wordChecker(gameObject.userPressed);
            gameObject.guessed(gameObject.wordArray);
            answerSpan.innerHTML = gameObject.answer.join(", ");
            gameObject.update();
            gameObject.checkWin(gameObject.wArrayString, gameObject.aArrayString);
        }

        gameObject.game();

    </script>

</body>

</html>