<!DOCTYPE html>
<html lang="en-us">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>My First Object</title>
  <link rel="stylesheet" type="text/css" href="reset.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    integrity="sha384-ggOyR0iXCbMQv3Xipma34MD+dH/1fQ784/j6cY/iJTQUOhcWr7x9JvoRxT2MZw1T" crossorigin="anonymous">
  <link rel="stylesheet" href="style.css">
  
</head>

<body>

  <div id="game">
    <h1>Time to play some hangman!</h1>
  </div>

  <div class="container">
    <div class="row">
      <div class="col-8">
        <div id="used">
          <p>Used words: <span id="wordsused"></span></p>
        </div>
        <div id="gameSpaces">
          <p>Guess!: <span id="answer"></span> </p>
        </div>
      </div>

      <div class="col-4">
        <div class="score-board">
          <div id="chances">Chances left: <span id="chancescount">10</span> </div>
          <div id="wins">Games won: <span id="wincount">0</span></div>
          <div id="losses">Games lost: <span id="lostcount">0</span></div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-3"><input type='text' id='foo'><div onclick='document.getElementById("foo").focus();'>click</div></div>
      <div class="col-6">
        <div id="message">
          <p id="finalmessage">Make your guess user!</p>
        </div>
      </div>
      <div class="col-3"></div>
    </div>

  </div>

  <script>

    // Gets Link for Theme Song

    function sound() {
      var audioElement = document.createElement("audio");
      audioElement.setAttribute("src", "lose.mp3");
      audioElement.play();
    }



    // Variables for DOM manipulation

    let gamesWon = document.getElementById("wincount");
    let gamesLost = document.getElementById("lostcount");
    let result = document.getElementById("finalmessage");
    let wordsUsedSpan = document.getElementById("wordsused");
    let answerSpan = document.getElementById("answer");
    let message = document.getElementById("finalmessage");
    let chancesSpan = document.getElementById("chancescount");
    let audioLose = document.createElement("audio");
    audioLose.setAttribute("src", "lose.mp3");
    let audioWin = document.createElement("audio");
    audioWin.setAttribute("src", "win.mp3");
    // OBJ

    var gameObject = {
      userPressed: "",
      canUse: ["a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z"],
      words: ["madonna", "seventies", "random", "jackson", "problem"],
      wordsUsed: [],
      answer: [],
      wordArray: [],
      chances: 10,
      arrayTracker: 0,
      wins: 0,
      losses: 0,
      wArrayString: "",
      aArrayString: "",
      checkWin: function (string1, string2) {
        if (string1 === string2) {
          audioWin.play();
          message.innerHTML = "You won!";
          this.wins++
          gamesWon.innerHTML = this.wins;
          this.reset();
        }
        else if (this.chances === 0) {
          audioLose.play();
          message.innerHTML = "You lost!";
          this.losses++;
          gamesLost.innerHTML = this.losses;
          this.reset();
        }
      },
      guessed: function (rand) {
        for (i = 0; i < rand.length; i++) {
          if (this.userPressed === this.wordArray[i]) {
            this.answer[i] = this.wordArray[i];
          }
        }
      },
      setSpaces: function (string) {
        for (i = 0; i < string.length; i++) {
          this.answer[i] = "_";
        }
      },
      wordToArray: function (string) {
        this.wordArray = [];
        for (i = 0; i < string.length; i++) {
          this.wordArray[i] = string.charAt(i);
        }
      },
      wordChecker: function (word) {
        this.update();
        if (this.wordsUsed.includes(word) || this.answer.includes(word)) {
          message.innerHTML = "You already tried this word!";
          this.checkWin(this.wArrayString, this.aArrayString);
        }
        else if (this.canUse.includes(word) === false) {
          message.innerHTML = "You can only use words!";
        }
        else {
          if (this.wordArray.includes(word) && this.answer.includes(word) === false) {
            this.update();
            message.innerHTML = "You guessed a word";
            this.checkWin(this.wArrayString, this.aArrayString);
          }
          else if (this.wordsUsed.includes(word) === false) {
            message.innerHTML = "Try again";
            this.wordsUsed[this.arrayTracker] = this.userPressed;
            this.arrayTracker++;
            this.chances--;
            wordsUsedSpan.innerHTML = this.wordsUsed.join(", ");
            chancesSpan.innerHTML = this.chances;
            if (this.chances === 0) {
              this.checkWin(this.wArrayString, this.aArrayString);
            }
          }
        }
      },
      reset: function () {
        this.answer = [];
        this.wordsUsed = [];
        this.chances = 10;
        chancesSpan.innerHTML = this.chances;
        this.arrayTracker = 0;
        this.wArrayString = "";
        this.aArrayString = "";
        wordsUsedSpan.innerHTML = this.wordsUsed.join(", ");
        this.update();
        this.game();
      },
      update: function () {
        this.aArrayString = "";
        this.wArrayString = "";
        this.wArrayString = this.wordArray.join("");
        this.aArrayString = this.answer.join("");
      },
      game: function () {
        var rand = gameObject.words[Math.floor(Math.random() * gameObject.words.length)];
        this.wordToArray(rand);
        this.setSpaces(rand);
        this.wArrayString = this.wordArray.join("");
        this.aArrayString = this.answer.join("");
        answerSpan.innerHTML = this.answer.join(" , ");
      }
    };

    // Key Functions 

    document.onkeydown = function (event) {
      gameObject.userPressed = event.key;
      gameObject.update();
    }

    document.onkeyup = function (event) {
      gameObject.wordChecker(gameObject.userPressed);
      gameObject.guessed(gameObject.wordArray);
      answerSpan.innerHTML = gameObject.answer.join(" , ");
      gameObject.update();
      gameObject.checkWin(gameObject.wArrayString, gameObject.aArrayString);
    }

    gameObject.game();

  </script>

</body>

</html>